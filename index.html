<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Dice Game (Game1)</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  background: #0f172a;
  color: #fff;
  font-family: Arial, sans-serif;
  text-align: center;
  padding: 30px;
}
h1 { margin-bottom: 10px; }
.balance { margin-bottom: 20px; font-size: 18px; }

button {
  padding: 12px 18px;
  margin: 6px;
  font-size: 15px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
}
.bet { background: #22c55e; color: #000; }
.roll { background: #38bdf8; color: #000; margin-top: 10px; }
.custom { background: #fbbf24; color: #000; }

.dice {
  font-size: 50px;
  margin: 10px;
}

.result {
  white-space: pre-line;
  margin-top: 15px;
  font-size: 17px;
}
</style>
</head>

<body>

<h1 id="title"></h1>
<div class="balance" id="balance"></div>

<div id="bet-area"></div>

<div>
  <button class="roll" onclick="roll()">üé≤ Roll</button>
</div>

<div>
  <div id="playerDice" class="dice">üé≤</div>
  <div id="bankerDice" class="dice">üé≤</div>
</div>

<div id="result" class="result"></div>

<script>
/* ======================
   Telegram Init
====================== */
const tg = Telegram.WebApp;
tg.ready();

/* ======================
   ‰∏âËØ≠Â≠óÂÖ∏
====================== */
const I18N = {
  zh: {
    title: "üé≤ È™∞Â≠êÊ∏∏ÊàèÔºàÊØîÂ§ßÂ∞èÔºâ",
    balance: "‰ΩôÈ¢ù",
    bet_ok: "‚úÖ Â∑≤‰∏ãÊ≥®",
    roll_first: "ËØ∑ÂÖà‰∏ãÊ≥®",
    win: "üèÜ Áé©ÂÆ∂ËÉúÂà©",
    lose: "‚ùå Áé©ÂÆ∂Â§±Ë¥•",
    draw: "ü§ù Âπ≥Â±Ä",
    enter_amount: "ËØ∑ËæìÂÖ•‰∏ãÊ≥®ÈáëÈ¢ù"
  },
  en: {
    title: "üé≤ Dice Game (Big / Small)",
    balance: "Balance",
    bet_ok: "‚úÖ Bet placed",
    roll_first: "Please place a bet",
    win: "üèÜ You Win",
    lose: "‚ùå You Lose",
    draw: "ü§ù Draw",
    enter_amount: "Enter bet amount"
  },
  ms: {
    title: "üé≤ Permainan Dadu (Besar / Kecil)",
    balance: "Baki",
    bet_ok: "‚úÖ Pertaruhan diterima",
    roll_first: "Sila buat pertaruhan",
    win: "üèÜ Anda Menang",
    lose: "‚ùå Anda Kalah",
    draw: "ü§ù Seri",
    enter_amount: "Masukkan jumlah pertaruhan"
  }
};

/* ======================
   ËØ≠Ë®ÄËØÜÂà´
====================== */
function detectLang() {
  const code = tg.initDataUnsafe?.user?.language_code || "en";
  if (code.startsWith("zh")) return "zh";
  if (code.startsWith("ms")) return "ms";
  return "en";
}
const LANG = detectLang();
const T = I18N[LANG];

/* ======================
   Ê∏∏ÊàèÁä∂ÊÄÅ
====================== */
let balance = 1000;
let currentBet = 0;
let rolling = false;

/* ======================
   ÂàùÂßãÂåñ UI
====================== */
document.getElementById("title").innerText = T.title;
updateBalance();
renderBetButtons();

/* ======================
   UI Functions
====================== */
function updateBalance() {
  document.getElementById("balance").innerText =
    `${T.balance}: ${balance}`;
}

function renderBetButtons() {
  const bets = [1,2,5,10,15,30,50,100,150,300,500];
  const area = document.getElementById("bet-area");
  area.innerHTML = "";
  bets.forEach(b => {
    const btn = document.createElement("button");
    btn.className = "bet";
    btn.innerText = b;
    btn.onclick = () => bet(b);
    area.appendChild(btn);
  });

  const custom = document.createElement("button");
  custom.className = "custom";
  custom.innerText = "‚úèÔ∏è";
  custom.onclick = customBet;
  area.appendChild(custom);
}

function bet(amount) {
  if (rolling) return;
  currentBet = amount;
  document.getElementById("result").innerText =
    `${T.bet_ok}: ${amount}`;
}

function customBet() {
  if (rolling) return;
  const v = prompt(T.enter_amount);
  const amt = parseInt(v);
  if (!amt || amt <= 0) return;
  bet(amt);
}

/* ======================
   È™∞Â≠êÂä®Áîª
====================== */
function animateDice(el) {
  return new Promise(resolve => {
    let count = 0;
    const interval = setInterval(() => {
      const val = Math.floor(Math.random() * 6) + 1;
      el.innerText = `üé≤ ${val}`;
      count++;
      if (count >= 12) {
        clearInterval(interval);
        resolve(val);
      }
    }, 100);
  });
}

/* ======================
   Game1 Ê†∏ÂøÉÈÄªËæë
====================== */
async function roll() {
  if (rolling) return;
  if (!currentBet) {
    document.getElementById("result").innerText = T.roll_first;
    return;
  }

  rolling = true;
  document.getElementById("result").innerText = "";

  const player = await animateDice(
    document.getElementById("playerDice")
  );
  const banker = await animateDice(
    document.getElementById("bankerDice")
  );

  let resText;
  if (player > banker) {
    balance += currentBet;
    resText = T.win;
  } else if (player < banker) {
    balance -= currentBet;
    resText = T.lose;
  } else {
    resText = T.draw;
  }

  updateBalance();
  document.getElementById("result").innerText =
    `üé≤ Áé©ÂÆ∂: ${player}\nüé≤ Â∫ÑÂÆ∂: ${banker}\n\n${resText}`;

  currentBet = 0;
  rolling = false;
}
</script>

</body>
</html>


