<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />

<meta name="viewport"
  content="width=device-width,
           initial-scale=1.0,
           maximum-scale=1.0,
           user-scalable=no,
           viewport-fit=cover">

<title>Dice Game</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #0f172a;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

#app {
  min-height: 100vh;
  max-width: 420px;
  margin: 0 auto;
  padding: 20px 16px env(safe-area-inset-bottom);
  box-sizing: border-box;
  text-align: center;
}

/* æ ‡é¢˜ */
h1 {
  margin: 10px 0 5px;
  font-size: 22px;
}

#balance {
  opacity: .85;
  margin-bottom: 15px;
}

/* ä¸‹æ³¨æŒ‰é’® */
.bet-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  margin-bottom: 12px;
}

.bet {
  background: #22c55e;
  color: #000;
  border-radius: 8px;
  padding: 10px 0;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
}

.bet.custom {
  background: #facc15;
}

/* Roll æŒ‰é’® */
#rollBtn {
  margin: 15px auto;
  padding: 12px 26px;
  background: #38bdf8;
  border-radius: 10px;
  color: #000;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
}

/* éª°å­åŒº */
.dice-area {
  display: flex;
  justify-content: center;
  gap: 24px;
  margin: 20px 0;
}

/* SVG éª°å­åŠ¨ç”» */
.dice {
  width: 80px;
  height: 80px;
  animation: none;
}

.roll-anim {
  animation: spin 0.9s ease-in-out;
}

@keyframes spin {
  0% { transform: rotate(0deg) scale(1); }
  50% { transform: rotate(360deg) scale(1.15); }
  100% { transform: rotate(720deg) scale(1); }
}

/* ç»“æœ */
#result {
  margin-top: 10px;
  font-size: 15px;
  white-space: pre-line;
}
</style>
</head>

<body>
<div id="app">

<h1 id="title"></h1>
<div id="balance"></div>

<div class="bet-grid" id="betGrid"></div>

<div id="rollBtn">ğŸ² Roll</div>

<div class="dice-area">
  <div id="playerDice"></div>
  <div id="bankerDice"></div>
</div>

<div id="result"></div>

</div>

<script>
/* ================= Telegram Init ================= */
const tg = Telegram.WebApp;
tg.ready();
tg.expand();
tg.enableClosingConfirmation();

/* ================= I18N ================= */
const I18N = {
  zh: {
    title: "ğŸ² éª°å­æ¸¸æˆï¼ˆæ¯”å¤§å°ï¼‰",
    balance: "ä½™é¢",
    bet_ok: "âœ… å·²ä¸‹æ³¨",
    roll_first: "è¯·å…ˆä¸‹æ³¨",
    win: "ğŸ† ç©å®¶èƒœåˆ©",
    lose: "âŒ ç©å®¶å¤±è´¥",
    draw: "ğŸ¤ å¹³å±€"
  },
  en: {
    title: "ğŸ² Dice Game (Big / Small)",
    balance: "Balance",
    bet_ok: "âœ… Bet placed",
    roll_first: "Please place a bet",
    win: "ğŸ† You Win",
    lose: "âŒ You Lose",
    draw: "ğŸ¤ Draw"
  },
  ms: {
    title: "ğŸ² Permainan Dadu (Besar / Kecil)",
    balance: "Baki",
    bet_ok: "âœ… Pertaruhan diterima",
    roll_first: "Sila buat pertaruhan",
    win: "ğŸ† Anda Menang",
    lose: "âŒ Anda Kalah",
    draw: "ğŸ¤ Seri"
  }
};

function detectLang() {
  const code = tg.initDataUnsafe?.user?.language_code || "en";
  if (code.startsWith("zh")) return "zh";
  if (code.startsWith("ms")) return "ms";
  return "en";
}

const LANG = detectLang();
const T = I18N[LANG];

/* ================= Game State ================= */
let balance = 1000;
let betAmount = 0;

const betValues = [1,2,5,10,15,30,50,100,150,300,500];

/* ================= UI Init ================= */
document.getElementById("title").innerText = T.title;
updateBalance();

const betGrid = document.getElementById("betGrid");
betValues.forEach(v => {
  const b = document.createElement("div");
  b.className = "bet";
  b.innerText = v;
  b.onclick = () => placeBet(v);
  betGrid.appendChild(b);
});

const custom = document.createElement("div");
custom.className = "bet custom";
custom.innerText = "âœï¸";
custom.onclick = () => {
  const v = prompt("Enter amount:");
  if (v && !isNaN(v)) placeBet(Number(v));
};
betGrid.appendChild(custom);

/* ================= Dice SVG ================= */
function diceSVG(num) {
  return `
<svg class="dice" viewBox="0 0 100 100">
<rect x="5" y="5" width="90" height="90" rx="16" fill="#e5e7eb"/>
${dots(num)}
</svg>`;
}

function dots(n) {
  const pos = {
    1:[[50,50]],
    2:[[30,30],[70,70]],
    3:[[30,30],[50,50],[70,70]],
    4:[[30,30],[70,30],[30,70],[70,70]],
    5:[[30,30],[70,30],[50,50],[30,70],[70,70]],
    6:[[30,30],[70,30],[30,50],[70,50],[30,70],[70,70]]
  };
  return pos[n].map(p=>`<circle cx="${p[0]}" cy="${p[1]}" r="6" fill="#111"/>`).join("");
}

/* ================= Logic ================= */
function updateBalance() {
  document.getElementById("balance").innerText =
    `${T.balance}: ${balance}`;
}

function placeBet(v) {
  betAmount = v;
  document.getElementById("result").innerText =
    `${T.bet_ok}: ${v}`;
}

document.getElementById("rollBtn").onclick = async () => {
  if (!betAmount) {
    document.getElementById("result").innerText = T.roll_first;
    return;
  }

  const p = Math.floor(Math.random()*6)+1;
  const b = Math.floor(Math.random()*6)+1;

  const pd = document.getElementById("playerDice");
  const bd = document.getElementById("bankerDice");

  pd.innerHTML = diceSVG(p);
  pd.firstChild.classList.add("roll-anim");
  await sleep(900);

  bd.innerHTML = diceSVG(b);
  bd.firstChild.classList.add("roll-anim");
  await sleep(900);

  let res;
  if (p > b) { balance += betAmount; res = T.win; }
  else if (p < b) { balance -= betAmount; res = T.lose; }
  else res = T.draw;

  betAmount = 0;
  updateBalance();

  document.getElementById("result").innerText =
    `ğŸ² ç©å®¶: ${p}\nğŸ² åº„å®¶: ${b}\n\n${res}`;
};

function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }
</script>

</body>
</html>



