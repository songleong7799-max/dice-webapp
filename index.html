<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
      content="width=device-width,
               initial-scale=1.0,
               maximum-scale=1.0,
               user-scalable=no,
               viewport-fit=cover">

<title>Dice Game</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #0f172a;
  color: #fff;
  font-family: Arial, sans-serif;
}

#app {
  min-height: 100vh;
  max-width: 420px;
  margin: 0 auto;
  padding: 20px 16px env(safe-area-inset-bottom);
  box-sizing: border-box;
  text-align: center;
}

h2 {
  margin: 10px 0 4px;
}

#balance {
  opacity: .9;
  margin-bottom: 16px;
}

.bet-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin-bottom: 14px;
}

.bet-btn {
  background: #22c55e;
  border: none;
  border-radius: 10px;
  padding: 10px 0;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
}

.bet-btn.custom {
  background: #facc15;
}

#roll-btn {
  width: 100%;
  background: #38bdf8;
  border: none;
  border-radius: 12px;
  padding: 14px;
  font-size: 16px;
  font-weight: 700;
  margin: 10px 0 18px;
  cursor: pointer;
}

#dice-area {
  display: flex;
  justify-content: center;
  gap: 24px;
  font-size: 64px;
  margin: 10px 0;
}

.dice.rolling {
  animation: spin .6s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

#result {
  white-space: pre-line;
  margin-top: 10px;
  font-size: 15px;
}

/* è‡ªå®šä¹‰é‡‘é¢å¼¹çª— */
#modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.65);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

#modal-box {
  background: #0f172a;
  padding: 20px;
  border-radius: 16px;
  width: 85%;
  max-width: 320px;
}

#modal-box h3 {
  margin: 0 0 12px;
}

#modal-box input {
  width: 100%;
  padding: 12px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  text-align: center;
  margin-bottom: 14px;
}

#modal-box button {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  font-weight: 700;
  border-radius: 10px;
  border: none;
  background: #22c55e;
}
</style>
</head>

<body>
<div id="app">

<h2 id="title"></h2>
<div id="balance"></div>

<div class="bet-grid" id="bets"></div>

<button id="roll-btn" onclick="roll()">ğŸ² Roll</button>

<div id="dice-area">
  <div id="player-dice">ğŸ²</div>
  <div id="banker-dice">ğŸ²</div>
</div>

<div id="result"></div>

</div>

<!-- è‡ªå®šä¹‰é‡‘é¢å¼¹çª— -->
<div id="modal">
  <div id="modal-box">
    <h3 id="modal-title"></h3>
    <input id="custom-input" type="number" inputmode="numeric" />
    <button onclick="confirmCustom()">OK</button>
  </div>
</div>

<script>
/* Telegram Init */
const tg = Telegram.WebApp;
tg.ready();
tg.expand();

/* ä¸‰è¯­ */
const I18N = {
  zh: {
    title: "ğŸ² éª°å­æ¸¸æˆï¼ˆæ¯”å¤§å°ï¼‰",
    balance: "ä½™é¢",
    betPlaced: "âœ… å·²ä¸‹æ³¨",
    rollFirst: "è¯·å…ˆä¸‹æ³¨",
    win: "ğŸ† ç©å®¶èƒœåˆ©",
    lose: "âŒ ç©å®¶å¤±è´¥",
    draw: "ğŸ¤ å¹³å±€",
    player: "ç©å®¶",
    banker: "åº„å®¶",
    custom: "è¾“å…¥ä¸‹æ³¨é‡‘é¢"
  },
  en: {
    title: "ğŸ² Dice Game (Big / Small)",
    balance: "Balance",
    betPlaced: "âœ… Bet placed",
    rollFirst: "Please place a bet",
    win: "ğŸ† You Win",
    lose: "âŒ You Lose",
    draw: "ğŸ¤ Draw",
    player: "Player",
    banker: "Banker",
    custom: "Enter amount"
  },
  ms: {
    title: "ğŸ² Permainan Dadu (Besar / Kecil)",
    balance: "Baki",
    betPlaced: "âœ… Pertaruhan diterima",
    rollFirst: "Sila buat pertaruhan",
    win: "ğŸ† Anda Menang",
    lose: "âŒ Anda Kalah",
    draw: "ğŸ¤ Seri",
    player: "Pemain",
    banker: "Peniaga",
    custom: "Masukkan jumlah"
  }
};

function detectLang() {
  const c = tg.initDataUnsafe?.user?.language_code || "en";
  if (c.startsWith("zh")) return "zh";
  if (c.startsWith("ms")) return "ms";
  return "en";
}

const LANG = detectLang();
const T = I18N[LANG];

/* çŠ¶æ€ */
let balance = 1000;
let bet = 0;

/* UI */
document.getElementById("title").innerText = T.title;
updateBalance();

function updateBalance() {
  document.getElementById("balance").innerText =
    `${T.balance}: ${balance}`;
}

function showBet(amount) {
  document.getElementById("result").innerText =
    `${T.betPlaced}: ${amount}`;
}

/* ä¸‹æ³¨æŒ‰é’® */
const amounts = [
  1,2,5,10,15,30,50,
  100,150,300,500,
  800,1000,1500
];

const betsDiv = document.getElementById("bets");
amounts.forEach(v => {
  const b = document.createElement("button");
  b.className = "bet-btn";
  b.innerText = v;
  b.onclick = () => { bet = v; showBet(v); };
  betsDiv.appendChild(b);
});

const c = document.createElement("button");
c.className = "bet-btn custom";
c.innerText = "âœï¸";
c.onclick = openCustom;
betsDiv.appendChild(c);

/* è‡ªå®šä¹‰é‡‘é¢ */
function openCustom() {
  document.getElementById("modal-title").innerText = T.custom;
  document.getElementById("custom-input").value = "";
  document.getElementById("modal").style.display = "flex";
}

function confirmCustom() {
  const v = parseInt(document.getElementById("custom-input").value);
  if (!v || v <= 0) return;
  bet = v;
  document.getElementById("modal").style.display = "none";
  showBet(v);
}

/* éª°å­ */
function diceEmoji(n) {
  return ["âš€","âš","âš‚","âšƒ","âš„","âš…"][n-1];
}

function roll() {
  if (!bet) {
    document.getElementById("result").innerText = T.rollFirst;
    return;
  }

  const p = document.getElementById("player-dice");
  const b = document.getElementById("banker-dice");

  p.classList.add("rolling");
  b.classList.add("rolling");

  setTimeout(() => {
    const pv = Math.floor(Math.random()*6)+1;
    const bv = Math.floor(Math.random()*6)+1;

    p.classList.remove("rolling");
    b.classList.remove("rolling");

    p.innerText = diceEmoji(pv);
    b.innerText = diceEmoji(bv);

    let res;
    if (pv > bv) { balance += bet; res = T.win; }
    else if (pv < bv) { balance -= bet; res = T.lose; }
    else { res = T.draw; }

    bet = 0;
    updateBalance();

    document.getElementById("result").innerText =
      `ğŸ² ${T.player}: ${pv}\nğŸ² ${T.banker}: ${bv}\n\n${res}`;
  }, 1200);
}
</script>

</body>
</html>





